From 585748a15bba0422943fe4faf90cfa4cf7d0fb6b Mon Sep 17 00:00:00 2001
From: Jim Marshall <jim.marshall@codethink.co.uk>
Date: Sun, 7 Dec 2025 17:26:46 +0000
Subject: [PATCH 1/1] exposed struct netcode_network_simulator_t

---
 .../engine/src/vendor/netcode-1.2.3/netcode.c | 28 ---------------
 .../engine/src/vendor/netcode-1.2.3/netcode.h | 36 +++++++++++++++++++
 2 files changed, 36 insertions(+), 28 deletions(-)

diff --git a/Stardew/engine/src/vendor/netcode-1.2.3/netcode.c b/Stardew/engine/src/vendor/netcode-1.2.3/netcode.c
index c6f410d9..abd9ffdc 100755
--- a/Stardew/engine/src/vendor/netcode-1.2.3/netcode.c
+++ b/Stardew/engine/src/vendor/netcode-1.2.3/netcode.c
@@ -2345,34 +2345,6 @@ void * netcode_packet_queue_pop( struct netcode_packet_queue_t * queue, uint64_t
 
 // ----------------------------------------------------------------
 
-#define NETCODE_NETWORK_SIMULATOR_NUM_PACKET_ENTRIES ( NETCODE_MAX_CLIENTS * 256 )
-#define NETCODE_NETWORK_SIMULATOR_NUM_PENDING_RECEIVE_PACKETS ( NETCODE_MAX_CLIENTS * 64 )
-
-struct netcode_network_simulator_packet_entry_t
-{
-    struct netcode_address_t from;
-    struct netcode_address_t to;
-    double delivery_time;
-    uint8_t * packet_data;
-    int packet_bytes;
-};
-
-struct netcode_network_simulator_t
-{
-    void * allocator_context;
-    void * (*allocate_function)(void*,size_t);
-    void (*free_function)(void*,void*);
-    float latency_milliseconds;
-    float jitter_milliseconds;
-    float packet_loss_percent;
-    float duplicate_packet_percent;
-    double time;
-    int current_index;
-    int num_pending_receive_packets;
-    struct netcode_network_simulator_packet_entry_t packet_entries[NETCODE_NETWORK_SIMULATOR_NUM_PACKET_ENTRIES];
-    struct netcode_network_simulator_packet_entry_t pending_receive_packets[NETCODE_NETWORK_SIMULATOR_NUM_PENDING_RECEIVE_PACKETS];
-};
-
 struct netcode_network_simulator_t * netcode_network_simulator_create( void * allocator_context, 
                                                                        void * (*allocate_function)(void*,size_t), 
                                                                        void (*free_function)(void*,void*) )
diff --git a/Stardew/engine/src/vendor/netcode-1.2.3/netcode.h b/Stardew/engine/src/vendor/netcode-1.2.3/netcode.h
index 8aaf6f2b..5f0865f2 100755
--- a/Stardew/engine/src/vendor/netcode-1.2.3/netcode.h
+++ b/Stardew/engine/src/vendor/netcode-1.2.3/netcode.h
@@ -119,6 +119,42 @@ struct netcode_address_t
     uint8_t type;
 };
 
+#define NETCODE_NETWORK_SIMULATOR_NUM_PACKET_ENTRIES ( NETCODE_MAX_CLIENTS * 256 )
+#define NETCODE_NETWORK_SIMULATOR_NUM_PENDING_RECEIVE_PACKETS ( NETCODE_MAX_CLIENTS * 64 )
+
+struct netcode_network_simulator_packet_entry_t
+{
+    struct netcode_address_t from;
+    struct netcode_address_t to;
+    double delivery_time;
+    uint8_t * packet_data;
+    int packet_bytes;
+};
+
+struct netcode_network_simulator_t
+{
+    void * allocator_context;
+    void * (*allocate_function)(void*,size_t);
+    void (*free_function)(void*,void*);
+    float latency_milliseconds;
+    float jitter_milliseconds;
+    float packet_loss_percent;
+    float duplicate_packet_percent;
+    double time;
+    int current_index;
+    int num_pending_receive_packets;
+    struct netcode_network_simulator_packet_entry_t packet_entries[NETCODE_NETWORK_SIMULATOR_NUM_PACKET_ENTRIES];
+    struct netcode_network_simulator_packet_entry_t pending_receive_packets[NETCODE_NETWORK_SIMULATOR_NUM_PENDING_RECEIVE_PACKETS];
+};
+
+struct netcode_network_simulator_t * netcode_network_simulator_create( void * allocator_context, 
+                                                                       void * (*allocate_function)(void*,size_t), 
+                                                                       void (*free_function)(void*,void*) );
+
+void netcode_network_simulator_destroy( struct netcode_network_simulator_t * network_simulator );
+
+void netcode_network_simulator_reset( struct netcode_network_simulator_t * network_simulator );
+
 int netcode_parse_address( NETCODE_CONST char * address_string_in, struct netcode_address_t * address );
 
 char * netcode_address_to_string( struct netcode_address_t * address, char * buffer );
-- 
2.43.0

